# -------------------------------------------------------------------
# 启动行为设置
# -------------------------------------------------------------------

#shell /opt/homebrew/bin/tmux new -A -s main

# 确保以 Login Shell 模式启动 (这样 Tmux 里的 PATH 才是对的)
shell_integration enabled

# ==============================
# 1. 字体设置 (Font)
# ==============================
font_family      Monaco
font_size        14.0

# 保持 Ligatures 开启
disable_ligatures never

# 基础样式
bold_font        auto
italic_font      auto
bold_italic_font auto

# --- 字体补丁 (Symbol Maps) ---
# 中文支持: 苹方
symbol_map U+4E00-U+9FFF,U+3400-U+4DBF,U+3000-U+303F,U+FF00-U+FFEF PingFang SC

# 图标支持: Symbols Nerd Font Mono (补全 Monaco 缺失的图标)
symbol_map U+23FB-U+23FE,U+2665,U+26A1,U+2B58,U+E000-U+E00A,U+E0A0-U+E0A3,U+E0B0-U+E0D4,U+E200-U+E2A9,U+E300-U+E3E3,U+E5FA-U+E6AA,U+E700-U+E7C5,U+EA60-U+EBEB,U+F000-U+F2E0,U+F300-U+F32F,U+F400-U+F4A9,U+F500-U+F8FF,U+F0001-U+F1AF0 Symbols Nerd Font Mono

# ==============================
# 2. 窗口行为
# ==============================
confirm_os_window_close 0
hide_window_decorations titlebar-only
window_padding_width 15
background_opacity 0.6
background_blur 30
remember_window_size yes

# ==============================
# 3. 标签栏 (Tab Bar)
# ==============================
tab_bar_edge top
tab_bar_style powerline
tab_powerline_style slanted

# ==============================
# 4. 按键映射 (Key Mapping)
# ==============================
# 关键设置：让 Option 键充当 Alt，这使得 Nvim 中的 <A-j> 生效
macos_option_as_alt yes

# --- 缩放与全屏 ---
map cmd+enter toggle_fullscreen
map cmd+equal change_font_size all +2.0
map cmd+minus change_font_size all -2.0
map cmd+0 change_font_size all 0

# --- Vim / Shell 快捷指令 ---
# 注意：这些命令会直接发送文本，请确保你在 Vim 模式下使用
map cmd+s send_text all \e:w\r
map cmd+p send_text all :Telescope find_files\r
map cmd+shift+f send_text all :Telescope live_grep\r
map cmd+b send_text all :Neotree toggle\r

# --- Kitty 原生标签页导航 ---
map ctrl+shift+1 goto_tab 1
map ctrl+shift+2 goto_tab 2
map ctrl+shift+3 goto_tab 3
map ctrl+shift+4 goto_tab 4
map ctrl+shift+5 goto_tab 5
map ctrl+shift+6 goto_tab 6
map ctrl+shift+7 goto_tab 7
map ctrl+shift+8 goto_tab 8
map ctrl+shift+9 goto_tab 9
map ctrl+shift+t new_tab_with_cwd
map ctrl+shift+n new_os_window
map ctrl+shift+o next_layout
map ctrl+shift+f show_scrollback

# --- Kitty 原生分屏导航 ---
map ctrl+shift+h neighboring_window left
map ctrl+shift+j neighboring_window down
map ctrl+shift+k neighboring_window up
map ctrl+shift+l neighboring_window right
map ctrl+shift+z toggle_layout stack

# ============================================
# 5. Tmux 快捷键透传 (Magic)
# ============================================
# 原理：组合键发送 Prefix (Ctrl+Space) 然后发送具体 Tmux 指令

# Cmd+1~9 -> 切换 Tmux 窗口
map cmd+1 combine : send_key ctrl+space : send_key 1
map cmd+2 combine : send_key ctrl+space : send_key 2
map cmd+3 combine : send_key ctrl+space : send_key 3
map cmd+4 combine : send_key ctrl+space : send_key 4
map cmd+5 combine : send_key ctrl+space : send_key 5
map cmd+6 combine : send_key ctrl+space : send_key 6
map cmd+7 combine : send_key ctrl+space : send_key 7
map cmd+8 combine : send_key ctrl+space : send_key 8
map cmd+9 combine : send_key ctrl+space : send_key 9

# Cmd+t -> 新建窗口 (Prefix + c)
map cmd+t combine : send_key ctrl+space : send_key c

# Cmd+w -> 关闭当前面板 (Prefix + x) -> 注意这会询问 y/n
map cmd+w combine : send_key ctrl+space : send_key x

# [修正] Cmd+n -> 下一个窗口 (Prefix + n)
map cmd+n combine : send_key ctrl+space : send_key n

# [修正] Cmd+Shift+n -> 上一个窗口 (Prefix + p)
map cmd+shift+n combine : send_key ctrl+space : send_key p

# Tmux 分屏操作
map ctrl+shift+[ combine : send_key ctrl+space : send_key {
map ctrl+shift+] combine : send_key ctrl+space : send_key }
map cmd+shift+w combine : send_key ctrl+space : send_key w

# Cmd+z -> Tmux 面板最大化/恢复 (Prefix + z)
map cmd+z combine : send_key ctrl+space : send_key z

# 其他 Tmux 指令
map cmd+shift+h combine : send_key ctrl+space : send_key space
